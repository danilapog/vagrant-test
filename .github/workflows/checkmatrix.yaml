name: check matrix

on:
  push:
  
  
env:
  COMPANY_NAME: "danilaworker"
  PRODUCT_NAME: "documentserver" 
  
jobs:
  build:
    name: Check docker manifest

    runs-on: ubuntu-latest
    strategy:
      matrix:
        #compose: [ "postgresql.yaml" ]
        #variables: [ "POSTGRESQL_VERSION=9 IMMORTAL=FOO ANOTHER=BOO" ]
        #include: 
        #  - compose: "postgresql.yaml" 
        #    variables: "POSTGRESQL_VERSION=10 IMMORTAL=DUKE ANOTHER=NUKEM" 
         variables: [ "", "POSTGRESQL_VERSION=9", "POSTGRESQL_VERSION=10", "POSTGRESQL_VERSION=11", "POSTGRESQL_VERSION=12" ]
         compose: [ "postgresql.yaml" ]
         include: 
           - variables: "MYSQL_VERSION=8 DUKE=NUKEM" 
             compose: "mysql.yaml"
           - variables: "MYSQL_VERSION=5"
             compose: "mysql.yaml"
             
         #variables: [ "POSTGRESQL_VERSION=10", "IMMORTAL=9", "ANOTHER=8" ]
    steps:
      - name: Checkout ${{ matrix.variables }}
        run: |
            export config=${{ matrix.compose }}
            echo "export variables for ${{ matrix.compose }}"
            for v in ${{ matrix.variables }}; do
                export ${v}
            done
            echo config file is ${config}
            echo postgresql version is ${POSTGRESQL_VERSION}
            echo mysql version is ${MYSQL_VERSION}
            echo duke version is ${DUKE}
